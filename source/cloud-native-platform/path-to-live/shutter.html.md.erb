---
title: Shutter Implementation and Design
last_reviewed_on: 2024-01-25
review_in: 6 months
weight: 5
---

# <%= current_page.data.title %>

## Purpose
The purpose of this document is to describe the shutter solution design and its end to end implementation.

## Solution

![Shutter Solution Design Docs](/images/shutter_solution_static_webapp.png)

## Default shutter page
By default the following shutter page is used as per the GOV.UK patterns [service-unavailable-pages](https://design-system.service.gov.uk/patterns/service-unavailable-pages/)


## Implementation and Customization
Creating and Enabling the shutter solution for an application is a 3 step process as outlined below:

- By default, all applications are provisioned with an `Azure Static Web App`. If you wish to exclude this feature, you can set the value of [shutter_app](https://github.com/hmcts/azure-platform-terraform/blob/697bea554cad5b19f5e822b859fd3a86b32e4ce3/environments/prod/prod.tfvars#L2316) to `false`.
- To upload static content to an Azure Web App, you can use the repository named [azure-shutter-pages](https://github.com/hmcts/azure-shutter-pages).
- Enable shutter with a DNS swap


### Enable shutter with a DNS swap
Now everything is setup to render shutter page. Swap the DNS from Azure FrontDoor to Azure Static Web App endpoint with the following steps

- Clone the [azure-public-dns](https://github.com/hmcts/azure-public-dns) repository
- Lets assume this application need to be shuttered `www.decree-absolute.apply-divorce.service.gov.uk`
- Create a PR with the appropriate [prod zone](https://github.com/hmcts/azure-public-dns/blob/a24128ffdc47687937cbab37aaa46040786c7955/environments/prod/apply-divorce-service-gov-uk.yml#L41)
- The above contents will be updated as follows:

```
- name: "www.decree-absolute"
  ttl: 300
  record: "hmcts-prod.azurefd.net"
  shutter: true
```

`shutter: true` will enable the shutter page and redirect all the traffic to Azure CDN.
`shutter: false` will disable the shutter page and redirect all the traffic back to Azure Frontdoor.

Note to enable shutter with DNS swap - this is a self service request and does not require PlatOps to create, approve or merge.  Therefore this can be done out of hours without a PlatOps resource.

## Shuttering errors

Shuttering error message - 404 Not Found (we couldn't find the page, please check the URL and try again) - this occurs when browsing to folders after the main URL, which have not been set up for shuttering.
Therefore teams need to update their custom shutter page.  See shutter page repos for examples, where there is shutter pages for further directories beyond the main URL:

https://github.com/hmcts/azure-shutter-pages/

Example: https://github.com/hmcts/azure-shutter-pages/tree/master/et-pet